from datamodel_parser.models.datamodel import Intro, File


class Content:

    def __init__(self, name = None, htmlname = None):
        self.name = name
        self.htmlname = htmlname
        self.data = {}
        self.set_file_id()
        self.set_intro()
        #self.set_description_from_intro()

    def set_file_id(self):
        #select id from file where name ilike 'manga-rss%';
        try: self.file = File.query.filter(File.name.ilike('%s%%' % self.htmlname)).one() if self.htmlname else None
        except: self.file = None
        self.file_id = self.file.id if self.file else None

    def set_intro_for_heading_title(self, heading_title = None):
        try: self.intro = Intro.query.filter(Intro.file_id==self.file_id).filter(Intro.heading_title == heading_title).one() if self.file_id and heading_title else None
        except: self.intro = None

    def set_description_from_intro(self):
        self.set_intro_for_heading_title(heading_title = 'General Description')
        self.data['description'] = self.intro.description
        
    def set_generated_by_from_intro(self):
        self.set_intro_for_heading_title(heading_title = 'Generated by Product')
        self.data['generated_by'] = self.intro.description
        
    def set_naming_convention_from_intro(self):
        self.set_intro_for_heading_title(heading_title = 'Naming Convention')
        self.data['naming_convention'] = self.intro.description
        
